# 🎯 新手入门指南 - 零基础开发调试教程

> 本指南专为完全不懂编程的小白用户编写，将手把手教你如何配置和运行这个微信小程序项目。

## 📚 目录

- [第一步：了解项目](#第一步了解项目)
- [第二步：安装必需软件](#第二步安装必需软件)
- [第三步：配置后端服务](#第三步配置后端服务)
- [第四步：配置前端小程序](#第四步配置前端小程序)
- [第五步：开始调试](#第五步开始调试)
- [常见问题解决](#常见问题解决)
- [调试技巧](#调试技巧)

---

## 第一步：了解项目

### 这个项目是什么？

这是一个**微信小程序分销系统**，包含两个主要部分：

1. **后端服务**（backend 文件夹）
   - 负责处理数据、业务逻辑
   - 需要在服务器或本地电脑上运行
   - 使用 Node.js 编写

2. **前端小程序**（qianduan 文件夹）
   - 用户看到和操作的界面
   - 在微信小程序中运行
   - 需要微信开发者工具打开

### 项目功能

- ✅ 用户登录注册
- ✅ 商品浏览购买
- ✅ 购物车和订单
- ✅ 分销赚佣金
- ✅ 库存管理
- ✅ 提现功能

---

## 第二步：安装必需软件

### 2.1 安装 Node.js（必需）

**Node.js 是什么？** 它是运行后端服务的环境，就像电脑需要操作系统一样。

#### Windows 用户安装步骤：

1. 访问官网：https://nodejs.org/
2. 下载 **LTS 版本**（推荐版本，更稳定）
3. 双击安装包，一路点击"下一步"
4. 安装完成后，打开"命令提示符"（CMD）
5. 输入以下命令检查是否安装成功：

```bash
node --version
npm --version
```

如果显示版本号（如 v18.17.0），说明安装成功！

#### Mac 用户安装步骤：

1. 访问官网：https://nodejs.org/
2. 下载 macOS 安装包
3. 双击 .pkg 文件安装
4. 打开"终端"（Terminal）
5. 输入 `node --version` 检查

### 2.2 安装 MySQL 数据库（必需）

**MySQL 是什么？** 它是存储数据的地方，就像一个超大的 Excel 表格。

#### Windows 用户安装步骤：

1. 访问：https://dev.mysql.com/downloads/mysql/
2. 下载 MySQL Community Server（免费版）
3. 安装时记住你设置的 **root 密码**（非常重要！）
4. 推荐使用默认端口：3306

#### Mac 用户安装步骤：

**推荐使用 Homebrew 安装：**

```bash
# 安装 Homebrew（如果没有）
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 安装 MySQL
brew install mysql

# 启动 MySQL
brew services start mysql

# 设置 root 密码
mysql_secure_installation
```

#### 验证 MySQL 安装：

打开命令行，输入：

```bash
mysql --version
```

显示版本号说明安装成功！

### 2.3 安装微信开发者工具（必需）

**这是什么？** 专门用来开发和调试微信小程序的工具。

1. 访问：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
2. 根据你的操作系统下载对应版本
3. 安装完成后，需要微信扫码登录

### 2.4 安装代码编辑器（推荐）

**推荐使用 Visual Studio Code（VSCode）：**

1. 访问：https://code.visualstudio.com/
2. 下载并安装
3. 这个工具可以方便地查看和编辑代码

---

## 第三步：配置后端服务

### 3.1 下载项目代码

#### 方法一：使用 Git（推荐）

1. 安装 Git：https://git-scm.com/downloads
2. 打开命令行，进入你想存放项目的文件夹
3. 执行命令：

```bash
git clone https://github.com/315fang/666.git
cd 666
```

#### 方法二：直接下载

1. 访问：https://github.com/315fang/666
2. 点击绿色的 "Code" 按钮
3. 选择 "Download ZIP"
4. 解压到任意文件夹

### 3.2 配置数据库

#### 步骤 1：创建数据库

1. 打开命令行
2. 登录 MySQL：

```bash
mysql -u root -p
```

3. 输入你的 MySQL 密码
4. 创建数据库：

```sql
CREATE DATABASE s2b2c_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

5. 验证创建成功：

```sql
SHOW DATABASES;
```

6. 退出 MySQL：

```sql
exit;
```

### 3.3 配置后端环境变量

#### 步骤 1：复制配置文件

在命令行中，进入 backend 文件夹：

```bash
cd backend
```

复制配置模板：

```bash
# Windows
copy .env.example .env

# Mac/Linux
cp .env.example .env
```

#### 步骤 2：编辑配置文件

用记事本或 VSCode 打开 `backend/.env` 文件，修改以下内容：

```env
# ========== 数据库配置 ==========
DB_HOST=localhost          # 不用改（本地开发）
DB_PORT=3306              # 不用改（默认端口）
DB_NAME=s2b2c_db         # 不用改（刚才创建的数据库名）
DB_USER=root              # 不用改（默认用户）
DB_PASSWORD=你的MySQL密码  # ⚠️ 改成你的 MySQL 密码

# ========== JWT 配置 ==========
# ⚠️ 重要：必须改成至少32个字符的随机字符串
JWT_SECRET=请改成一个超级长的随机密码至少32个字符abcdefghijklmn
ADMIN_JWT_SECRET=另一个超级长的随机密码也要至少32个字符abcdefg

# ========== 微信小程序配置 ==========
# ⚠️ 需要填写你自己的微信小程序信息
WECHAT_APPID=wx1b40a6e80f4326ab     # 你的小程序 AppID
WECHAT_SECRET=你的小程序AppSecret    # 你的小程序 AppSecret
```

**重要提示：**
- `DB_PASSWORD`：改成你安装 MySQL 时设置的密码
- `JWT_SECRET`：随便输入一个很长的字符串（至少32个字符）
- `WECHAT_APPID` 和 `WECHAT_SECRET`：需要在微信公众平台获取

### 3.4 安装后端依赖

在 backend 文件夹中执行：

```bash
npm install
```

**这个过程会：**
- 下载项目需要的所有依赖包
- 可能需要几分钟时间
- 看到很多文字输出是正常的

### 3.5 启动后端服务

#### 开发模式启动（推荐用于调试）：

```bash
npm run dev
```

#### 生产模式启动：

```bash
npm start
```

**成功的标志：**
看到类似这样的输出：

```
✅ 数据库连接成功
✅ 数据表已同步
🚀 服务器运行在: http://localhost:3000
📱 环境: development
```

**如果看到错误信息，请查看 [常见问题解决](#常见问题解决) 部分。**

### 3.6 测试后端是否正常

打开浏览器，访问：http://localhost:3000/health

如果看到：

```json
{
  "status": "ok",
  "message": "Server is running"
}
```

说明后端启动成功！🎉

---

## 第四步：配置前端小程序

### 4.1 配置小程序 AppID

#### 步骤 1：获取 AppID

1. 访问：https://mp.weixin.qq.com/
2. 登录微信公众平台
3. 进入"开发" > "开发管理" > "开发设置"
4. 复制 AppID

**如果没有小程序账号：**
- 可以使用测试号
- 或者先用项目自带的 AppID（仅用于学习）

#### 步骤 2：打开微信开发者工具

1. 启动微信开发者工具
2. 选择"小程序"
3. 点击"导入项目"

#### 步骤 3：导入项目

- **项目目录**：选择 `666/qianduan` 文件夹
- **AppID**：填写你的 AppID（或选择"测试号"）
- **项目名称**：随便填写，比如"分销小程序测试"

### 4.2 配置 API 地址

**重要：让小程序连接到后端服务**

#### 方法一：修改环境配置（推荐）

打开文件：`qianduan/config/env.js`

找到第 16 行，确保是这样的：

```javascript
const CURRENT_ENV = ENV_TYPES.DEVELOPMENT;
```

这样会自动使用开发环境的 API 地址：`https://dev-api.jxalk.cn/api`

#### 方法二：使用本地后端（如果你在本地运行后端）

如果你的后端运行在本地（http://localhost:3000），需要修改：

打开 `qianduan/config/env.js`，找到第 22-24 行：

```javascript
[ENV_TYPES.DEVELOPMENT]: {
    apiBaseUrl: 'http://localhost:3000/api',  // 改成本地地址
    debug: true,
```

**注意：** 使用本地地址需要在微信开发者工具中关闭"域名校验"：
- 右上角"详情"
- 勾选"不校验合法域名..."

### 4.3 编译和预览

1. 点击工具栏的"编译"按钮
2. 如果一切正常，你会看到小程序界面
3. 可以在模拟器中操作小程序

---

## 第五步：开始调试

### 5.1 后端调试

#### 查看后端日志

后端服务运行时，命令行会显示所有的请求日志：

```
[AUTH] 用户登录 { userId: 1, openid: 'xxx' }
[API] GET /api/products - 200 - 45ms
```

#### 测试 API 接口

**方法一：使用浏览器**

直接在浏览器访问：
- http://localhost:3000/health
- http://localhost:3000/api/products

**方法二：使用 Postman 或 Apifox**

这些工具可以发送各种 HTTP 请求，非常方便测试 API。

**方法三：使用 curl 命令**

```bash
# 测试登录接口
curl -X POST http://localhost:3000/api/login \
  -H "Content-Type: application/json" \
  -d '{"code":"test_code"}'
```

### 5.2 前端调试

#### 打开调试面板

在微信开发者工具中：
1. 点击工具栏的"调试器"
2. 会看到类似浏览器的开发者工具
3. 可以查看 Console、Network 等

#### 查看 Console 日志

在 Console 标签页，可以看到：
- 小程序输出的日志
- 错误信息
- API 请求结果

#### 查看网络请求

在 Network 标签页，可以看到：
- 所有 API 请求
- 请求参数
- 响应数据
- 请求耗时

#### 断点调试

1. 在代码编辑器中，点击行号添加断点
2. 操作小程序触发该代码
3. 程序会暂停，可以查看变量值

### 5.3 常用调试命令

#### 重启后端服务

在运行后端的命令行中：
- 按 `Ctrl + C` 停止服务
- 重新运行 `npm run dev`

#### 清空数据库

如果需要重置数据：

```bash
# 进入 backend 目录
cd backend

# 删除并重建数据库
mysql -u root -p
DROP DATABASE s2b2c_db;
CREATE DATABASE s2b2c_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
exit;

# 重启后端（会自动创建表结构）
npm run dev
```

---

## 常见问题解决

### 问题 1：后端启动失败 - 数据库连接错误

**错误信息：**
```
❌ 数据库连接失败: Access denied for user 'root'@'localhost'
```

**解决方案：**
1. 检查 `.env` 文件中的 `DB_PASSWORD` 是否正确
2. 尝试重新登录 MySQL 确认密码
3. 确保 MySQL 服务正在运行

**Windows 检查 MySQL 服务：**
```bash
# 查看 MySQL 服务状态
sc query MySQL80

# 启动 MySQL 服务
net start MySQL80
```

**Mac 检查 MySQL 服务：**
```bash
# 启动 MySQL
brew services start mysql

# 查看状态
brew services list
```

### 问题 2：后端启动失败 - 端口被占用

**错误信息：**
```
Error: listen EADDRINUSE: address already in use :::3000
```

**解决方案：**

**Windows：**
```bash
# 查看占用 3000 端口的程序
netstat -ano | findstr :3000

# 记下最后一列的 PID（进程ID），然后杀掉进程
taskkill /PID <进程ID> /F
```

**Mac/Linux：**
```bash
# 查找占用端口的进程
lsof -i :3000

# 杀掉进程
kill -9 <PID>
```

或者，修改 `.env` 文件中的 `PORT=3000` 改成其他端口，如 `PORT=3001`

### 问题 3：小程序编译错误 - process is not defined

**错误信息：**
```
ReferenceError: process is not defined
```

**解决方案：**

这个问题已经修复！确保你使用的是最新代码。

检查 `qianduan/config/env.js` 文件第 16 行是否是：

```javascript
const CURRENT_ENV = ENV_TYPES.DEVELOPMENT;
```

如果还是 `process.env.NODE_ENV`，需要改成上面的形式。

### 问题 4：小程序登录失败

**错误信息：**
```
登录失败：invalid code
```

**可能原因和解决方案：**

1. **AppID 配置错误**
   - 检查后端 `.env` 中的 `WECHAT_APPID`
   - 检查小程序导入时填写的 AppID
   - 确保两者一致

2. **AppSecret 配置错误**
   - 检查后端 `.env` 中的 `WECHAT_SECRET`
   - 去微信公众平台重新生成并复制

3. **开发环境限制**
   - 使用测试号时可能有限制
   - 尝试在真机上测试

### 问题 5：小程序无法连接后端

**表现：**
- 页面一直显示加载中
- Console 显示网络请求失败

**解决方案：**

1. **确认后端正在运行**
   - 检查后端命令行是否有输出
   - 浏览器访问 http://localhost:3000/health

2. **检查 API 地址配置**
   - 打开 `qianduan/config/env.js`
   - 确认 `apiBaseUrl` 配置正确

3. **关闭域名校验**（仅开发环境）
   - 微信开发者工具 > 详情 > 本地设置
   - 勾选"不校验合法域名..."

4. **检查网络代理**
   - 关闭 VPN 或代理软件
   - 确保防火墙没有阻止连接

### 问题 6：JWT Secret 长度不足

**错误信息：**
```
❌ 致命错误: JWT_SECRET 必须至少32个字符
```

**解决方案：**

打开 `backend/.env` 文件，修改：

```env
JWT_SECRET=abcdefghijklmnopqrstuvwxyz123456789012345678  # 至少32个字符
ADMIN_JWT_SECRET=zyxwvutsrqponmlkjihgfedcba987654321012  # 至少32个字符
```

随便输入一些字符，确保总长度 >= 32 个字符。

### 问题 7：npm install 失败

**错误信息：**
```
npm ERR! network timeout
```

**解决方案：**

1. **切换 npm 镜像源（推荐）**

```bash
# 使用淘宝镜像
npm config set registry https://registry.npmmirror.com

# 重新安装
npm install
```

2. **清除缓存**

```bash
npm cache clean --force
npm install
```

3. **使用 cnpm**

```bash
# 安装 cnpm
npm install -g cnpm --registry=https://registry.npmmirror.com

# 使用 cnpm 安装
cnpm install
```

---

## 调试技巧

### 技巧 1：使用 console.log 打印信息

**后端（Node.js）：**

```javascript
console.log('用户信息:', userInfo);
console.log('订单数据:', JSON.stringify(order, null, 2));
```

**前端（小程序）：**

```javascript
console.log('页面数据:', this.data);
console.log('API 响应:', res);
```

### 技巧 2：使用开发环境的调试功能

**后端调试：**

安装 VSCode 扩展：`Node.js Debug`

在 VSCode 中：
1. 打开 `backend/server.js`
2. 点击行号添加断点
3. 按 F5 启动调试

**前端调试：**

在微信开发者工具中：
1. 打开"调试器"
2. 在"Sources"标签查看源代码
3. 点击行号添加断点
4. 操作小程序触发代码

### 技巧 3：查看数据库数据

**方法一：使用命令行**

```bash
mysql -u root -p
USE s2b2c_db;

# 查看用户表
SELECT * FROM users;

# 查看订单表
SELECT * FROM orders;

# 查看最新的10条记录
SELECT * FROM orders ORDER BY id DESC LIMIT 10;

exit;
```

**方法二：使用图形化工具（推荐）**

下载安装：
- **MySQL Workbench**（官方工具）
- **Navicat**（功能强大，付费）
- **DBeaver**（免费开源）
- **HeidiSQL**（免费，Windows）

### 技巧 4：使用 Postman 测试 API

1. 下载 Postman：https://www.postman.com/
2. 创建新请求
3. 输入 URL：http://localhost:3000/api/products
4. 点击"Send"查看响应

可以测试：
- GET 请求（获取数据）
- POST 请求（创建数据）
- PUT 请求（更新数据）
- DELETE 请求（删除数据）

### 技巧 5：实时查看小程序 Storage

在微信开发者工具的调试器中：

1. 切换到"Storage"标签
2. 查看：
   - Storage：本地存储的数据
   - AppData：页面数据

可以实时修改数据进行测试。

### 技巧 6：模拟网络状态

在微信开发者工具中：
1. 工具栏 > 网络
2. 可以选择：
   - WiFi
   - 4G
   - 3G
   - 2G
   - 离线

测试不同网络环境下的表现。

### 技巧 7：清除缓存

**清除小程序缓存：**
```javascript
// 在调试器的 Console 中执行
wx.clearStorage()
```

**或者：**
- 工具栏 > 缓存 > 清除数据缓存

**清除后端缓存：**
- 重启后端服务即可

---

## 💡 开发建议

### 1. 版本控制

使用 Git 管理代码：

```bash
# 查看当前修改
git status

# 提交修改
git add .
git commit -m "修改了XXX功能"

# 推送到远程
git push
```

### 2. 边改边测

- 修改后端代码后，使用 `npm run dev` 会自动重启
- 修改前端代码后，点击"编译"按钮刷新

### 3. 做好备份

重要修改前：
```bash
# 创建备份分支
git checkout -b backup-20260210
git push origin backup-20260210

# 回到主分支
git checkout main
```

### 4. 阅读日志

遇到问题时：
1. 先看后端命令行的输出
2. 再看小程序的 Console
3. 查看 Network 请求详情

大部分问题都能从日志中找到线索。

### 5. 善用搜索

遇到错误信息：
1. 复制完整的错误信息
2. 在 Google 或百度搜索
3. 查看 Stack Overflow 的答案

---

## 📞 获取帮助

### 1. 查看项目文档

- `README.md` - 项目概述
- `backend/README.md` - 后端文档
- `WECHAT_MINIPROGRAM_FIX.md` - 常见问题修复

### 2. 查看示例代码

项目中有很多示例代码可以参考：
- `qianduan/pages/` - 各个页面的实现
- `backend/controllers/` - API 接口实现

### 3. 在线资源

- **微信小程序官方文档**：https://developers.weixin.qq.com/miniprogram/dev/framework/
- **Node.js 文档**：https://nodejs.org/docs/
- **Express 文档**：https://expressjs.com/
- **MySQL 文档**：https://dev.mysql.com/doc/

### 4. 社区支持

- **GitHub Issues**：https://github.com/315fang/666/issues
- **微信开发者社区**：https://developers.weixin.qq.com/community/
- **Stack Overflow**：https://stackoverflow.com/

---

## ✅ 快速检查清单

使用这个清单确保环境配置正确：

### 软件安装检查

- [ ] Node.js 已安装（`node --version` 显示版本号）
- [ ] npm 已安装（`npm --version` 显示版本号）
- [ ] MySQL 已安装并运行（`mysql --version` 显示版本号）
- [ ] 微信开发者工具已安装
- [ ] 代码编辑器已安装（推荐 VSCode）

### 后端配置检查

- [ ] 数据库 `s2b2c_db` 已创建
- [ ] `backend/.env` 文件已创建
- [ ] `.env` 中 `DB_PASSWORD` 已正确设置
- [ ] `.env` 中 `JWT_SECRET` 至少32个字符
- [ ] `.env` 中 `WECHAT_APPID` 和 `WECHAT_SECRET` 已填写
- [ ] `npm install` 成功完成
- [ ] 后端服务启动成功（显示"服务器运行在..."）
- [ ] 访问 http://localhost:3000/health 显示 "ok"

### 前端配置检查

- [ ] 微信开发者工具已登录
- [ ] 小程序项目已导入（`qianduan` 目录）
- [ ] AppID 已正确配置
- [ ] `qianduan/config/env.js` 中环境配置正确
- [ ] 关闭了"域名校验"（仅开发环境）
- [ ] 小程序编译成功
- [ ] 小程序界面正常显示

### 功能测试检查

- [ ] 小程序首页可以正常打开
- [ ] 可以查看商品列表
- [ ] 点击商品可以进入详情页
- [ ] Console 没有错误信息
- [ ] Network 中 API 请求返回 200

---

## 🎓 下一步学习

配置成功后，可以：

1. **学习修改页面**
   - 修改 `qianduan/pages/index/index.wxml` 改变首页布局
   - 修改 `qianduan/pages/index/index.wxss` 改变样式

2. **学习添加 API**
   - 在 `backend/routes/` 添加新路由
   - 在 `backend/controllers/` 添加业务逻辑

3. **学习数据库操作**
   - 查看 `backend/models/` 了解数据模型
   - 使用 Sequelize ORM 操作数据库

4. **阅读代码**
   - 从简单的页面开始，如登录页
   - 理解数据流向：前端 → API → 数据库

---

## 📝 附录

### A. 常用命令速查表

```bash
# Node.js 和 npm
node --version              # 查看 Node.js 版本
npm --version              # 查看 npm 版本
npm install                # 安装依赖
npm run dev                # 开发模式启动
npm start                  # 生产模式启动

# Git
git status                 # 查看状态
git add .                  # 添加所有修改
git commit -m "message"    # 提交
git push                   # 推送
git pull                   # 拉取

# MySQL
mysql -u root -p           # 登录 MySQL
SHOW DATABASES;            # 显示所有数据库
USE database_name;         # 使用某个数据库
SHOW TABLES;               # 显示所有表
exit;                      # 退出

# 系统
cd path/to/directory       # 切换目录
ls                         # 列出文件（Mac/Linux）
dir                        # 列出文件（Windows）
pwd                        # 显示当前路径
```

### B. 项目目录结构说明

```
666/
├── backend/              # 后端服务
│   ├── config/          # 配置文件
│   ├── controllers/     # 控制器（处理请求）
│   ├── models/          # 数据模型
│   ├── routes/          # 路由定义
│   ├── middleware/      # 中间件
│   ├── utils/           # 工具函数
│   ├── .env             # 环境变量（需要创建）
│   ├── .env.example     # 环境变量模板
│   ├── package.json     # 项目配置
│   └── server.js        # 入口文件
│
├── qianduan/            # 前端小程序
│   ├── pages/          # 页面文件
│   ├── components/     # 组件
│   ├── config/         # 配置
│   ├── utils/          # 工具函数
│   ├── assets/         # 静态资源
│   ├── app.js          # 小程序入口
│   ├── app.json        # 小程序配置
│   └── project.config.json  # 项目配置
│
└── docs/               # 文档
    └── 各种文档.md
```

### C. 环境变量完整说明

查看 `backend/.env.example` 文件，里面有详细的注释说明每个配置项的作用。

---

**🎉 恭喜你完成了配置！现在可以开始开发和调试了！**

如果遇到问题，请仔细阅读错误信息，并参考"常见问题解决"部分。

祝你开发顺利！💪
