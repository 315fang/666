<!--pages/order/refund-detail.wxml - é€€æ¬¾è¯¦æƒ…-->
<view class="container" wx:if="{{refund}}">
  <!-- çŠ¶æ€å¡ç‰‡ -->
  <view class="status-card status-{{refund.status}}">
    <text class="status-icon" wx:if="{{refund.status === 'pending'}}">â³</text>
    <text class="status-icon" wx:if="{{refund.status === 'approved'}}">âœ…</text>
    <text class="status-icon" wx:if="{{refund.status === 'rejected'}}">âŒ</text>
    <text class="status-icon" wx:if="{{refund.status === 'completed'}}">ğŸ‰</text>
    <text class="status-icon" wx:if="{{refund.status === 'cancelled'}}">ğŸš«</text>
    <text class="status-text">{{statusText[refund.status]}}</text>
    <text class="status-desc" wx:if="{{refund.status === 'rejected' && refund.reject_reason}}">
      æ‹’ç»åŸå› : {{refund.reject_reason}}
    </text>
    <text class="status-desc" wx:if="{{refund.status === 'approved' && refund.type === 'return_refund'}}">
      è¯·å°½å¿«å¯„å›å•†å“å¹¶å¡«å†™ç‰©æµå•å·
    </text>
  </view>

  <!-- é€€æ¬¾é‡‘é¢ -->
  <view class="amount-card">
    <text class="amount-label">é€€æ¬¾é‡‘é¢</text>
    <text class="amount-value">Â¥{{refund.amount}}</text>
  </view>

  <!-- å•†å“ä¿¡æ¯ -->
  <view class="card" wx:if="{{refund.order && refund.order.product}}">
    <view class="card-title">å•†å“ä¿¡æ¯</view>
    <view class="product-row">
      <image class="product-img" src="{{refund.order.product.images[0] || ''}}" mode="aspectFill" wx:if="{{refund.order.product.images && refund.order.product.images.length > 0}}"></image>
      <view class="product-info">
        <text class="product-name">{{refund.order.product.name}}</text>
        <text class="product-price">è®¢å•é‡‘é¢: Â¥{{refund.order.total_amount}}</text>
      </view>
    </view>
  </view>

  <!-- é€€æ¬¾ä¿¡æ¯ -->
  <view class="card">
    <view class="card-title">é€€æ¬¾ä¿¡æ¯</view>
    <view class="info-row">
      <text class="info-label">é€€æ¬¾å•å·</text>
      <text class="info-value">{{refund.refund_no}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">é€€æ¬¾ç±»å‹</text>
      <text class="info-value">{{typeText[refund.type]}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">é€€æ¬¾åŸå› </text>
      <text class="info-value">{{reasonText[refund.reason] || refund.reason}}</text>
    </view>
    <view class="info-row" wx:if="{{refund.description}}">
      <text class="info-label">é—®é¢˜æè¿°</text>
      <text class="info-value">{{refund.description}}</text>
    </view>
    <view class="info-row">
      <text class="info-label">ç”³è¯·æ—¶é—´</text>
      <text class="info-value">{{refund.createdAt || refund.created_at}}</text>
    </view>
    <view class="info-row" wx:if="{{refund.processed_at}}">
      <text class="info-label">å¤„ç†æ—¶é—´</text>
      <text class="info-value">{{refund.processed_at}}</text>
    </view>
    <view class="info-row" wx:if="{{refund.completed_at}}">
      <text class="info-label">å®Œæˆæ—¶é—´</text>
      <text class="info-value">{{refund.completed_at}}</text>
    </view>
    <view class="info-row" wx:if="{{refund.admin_remark}}">
      <text class="info-label">å®¢æœå¤‡æ³¨</text>
      <text class="info-value">{{refund.admin_remark}}</text>
    </view>
  </view>
</view>

<view class="loading-container" wx:if="{{loading}}">
  <text>åŠ è½½ä¸­...</text>
</view>
