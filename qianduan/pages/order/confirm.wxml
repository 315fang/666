<!--pages/order/confirm.wxml - è®¢å•ç¡®è®¤é¡µ-->
<view class="container">

  <!-- æ”¶è´§åœ°å€ -->
  <view class="section address-section" bindtap="onSelectAddress" wx:if="{{address}}">
    <view class="address-info">
      <view class="address-top">
        <text class="address-name">{{address.receiver_name}}</text>
        <text class="address-phone">{{address.phone}}</text>
        <text class="address-tag" wx:if="{{address.is_default}}">é»˜è®¤</text>
      </view>
      <view class="address-detail">
        {{address.province}} {{address.city}} {{address.district}} {{address.detail}}
      </view>
    </view>
    <text class="arrow">â€º</text>
  </view>

  <!-- æ— åœ°å€æç¤º -->
  <view class="section address-empty" bindtap="onAddAddress" wx:else>
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">è¯·æ·»åŠ æ”¶è´§åœ°å€</text>
    <text class="arrow">â€º</text>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="section goods-section">
    <view class="goods-item" wx:for="{{orderItems}}" wx:key="index">
      <image class="goods-image" src="{{item.image}}" mode="aspectFill"></image>
      <view class="goods-info">
        <text class="goods-name">{{item.name}}</text>
        <text class="goods-spec" wx:if="{{item.spec}}">{{item.spec}}</text>
        <view class="goods-bottom">
          <text class="goods-price">Â¥{{item.price}}</text>
          <text class="goods-quantity">Ã—{{item.quantity}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¤‡æ³¨ -->
  <view class="section remark-section">
    <text class="remark-label">è®¢å•å¤‡æ³¨</text>
    <input class="remark-input" 
           placeholder="é€‰å¡«ï¼Œå¯ç•™è¨€ç»™å–å®¶" 
           value="{{remark}}"
           bindinput="onRemarkInput"
           maxlength="100" />
  </view>

  <!-- åº•éƒ¨ç»“ç®—æ  -->
  <view class="bottom-bar">
    <view class="total-info">
      <text class="total-label">å…± {{totalCount}} ä»¶ï¼Œåˆè®¡ï¼š</text>
      <text class="total-price">Â¥{{totalAmount}}</text>
    </view>
    <view class="submit-btn {{submitting ? 'disabled' : ''}}" bindtap="onSubmit">
      <text>{{submitting ? 'æäº¤ä¸­...' : 'æäº¤è®¢å•'}}</text>
    </view>
  </view>

  <!-- æˆåŠŸå¼¹çª— -->
  <view class="success-popup {{showSuccess ? 'show' : ''}}">
    <view class="success-mask"></view>
    <view class="success-content">
      <view class="success-icon">
        <text>ğŸ‰</text>
      </view>
      <text class="success-title">ä¸‹å•æˆåŠŸ</text>
      <text class="success-desc">æ„Ÿè°¢æ‚¨çš„ä¿¡ä»»ï¼Œæˆ‘ä»¬ä¼šå°½å¿«å‘è´§</text>
      <view class="success-btns">
        <view class="btn-outline" bindtap="onViewOrder">æŸ¥çœ‹è®¢å•</view>
        <view class="btn-primary" bindtap="onBackHome">è¿”å›é¦–é¡µ</view>
      </view>
    </view>
  </view>
</view>
