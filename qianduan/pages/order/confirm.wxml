<!--pages/order/confirm.wxml - 订单确认页-->
<view class="container">

  <!-- 收货地址 -->
  <view class="section address-section" bindtap="onSelectAddress" wx:if="{{address}}">
    <view class="address-info">
      <view class="address-top">
        <text class="address-name">{{address.receiver_name}}</text>
        <text class="address-phone">{{address.phone}}</text>
        <text class="address-tag" wx:if="{{address.is_default}}">默认</text>
      </view>
      <view class="address-detail">
        {{address.province}} {{address.city}} {{address.district}} {{address.detail}}
      </view>
    </view>
    <text class="arrow">›</text>
  </view>

  <!-- 无地址提示 -->
  <view class="section address-empty" bindtap="onAddAddress" wx:else>
    <image class="empty-icon-img" src="/assets/icons/map-pin.svg" mode="aspectFit"/>
    <text class="empty-text">请添加收货地址</text>
    <text class="arrow">›</text>
  </view>

  <!-- 商品列表 -->
  <view class="section goods-section">
    <view class="goods-item" wx:for="{{orderItems}}" wx:key="index">
      <image class="goods-image" src="{{item.image}}" mode="aspectFill"></image>
      <view class="goods-info">
        <text class="goods-name">{{item.name}}</text>
        <text class="goods-spec" wx:if="{{item.spec}}">{{item.spec}}</text>
        <view class="goods-bottom">
          <text class="goods-price">¥{{item.price}}</text>
          <text class="goods-quantity">×{{item.quantity}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 备注 -->
  <view class="section remark-section">
    <text class="remark-label">订单备注</text>
    <input class="remark-input" 
           placeholder="选填，可留言给卖家" 
           value="{{remark}}"
           bindinput="onRemarkInput"
           maxlength="100" />
  </view>

  <!-- 底部结算栏 -->
  <view class="bottom-bar">
    <view class="total-info">
      <text class="total-label">共 {{totalCount}} 件，合计：</text>
      <text class="total-price">¥{{totalAmount}}</text>
    </view>
    <view class="submit-btn {{submitting ? 'disabled' : ''}}" bindtap="onSubmit">
      <text>{{submitting ? '提交中...' : '提交订单'}}</text>
    </view>
  </view>

  <!-- 成功弹窗 -->
  <view class="success-popup {{showSuccess ? 'show' : ''}}">
    <view class="success-mask"></view>
    <view class="success-content">
      <view class="success-icon">
        <image class="success-icon-img" src="/assets/icons/check-circle.svg" mode="aspectFit"/>
      </view>
      <text class="success-title">下单成功</text>
      <text class="success-desc">感谢您的信任，我们会尽快发货</text>
      <view class="success-btns">
        <view class="btn-outline" bindtap="onViewOrder">查看订单</view>
        <view class="btn-primary" bindtap="onBackHome">返回首页</view>
      </view>
    </view>
  </view>
</view>
