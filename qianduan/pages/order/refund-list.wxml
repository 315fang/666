<!--pages/order/refund-list.wxml - é€€è´§/é€€æ¬¾åˆ—è¡¨-->
<view class="container">
  <scroll-view class="refund-list" scroll-y bindscrolltolower="onLoadMore">
    <!-- åˆ—è¡¨å®¹å™¨ -->
    <view class="refund-list-container">
      <view class="refund-card" wx:for="{{refunds}}" wx:key="id" bindtap="onRefundTap" data-id="{{item.id}}">
      <!-- å¤´éƒ¨ -->
      <view class="refund-header">
        <text class="refund-type">{{typeText[item.type] || 'é€€æ¬¾'}}</text>
        <text class="refund-status status-{{item.status}}">{{statusText[item.status] || item.status}}</text>
      </view>

      <!-- å•†å“ä¿¡æ¯ -->
      <view class="refund-product" wx:if="{{item.order && item.order.product}}">
        <image class="product-img" src="{{item.order.product.images[0] || ''}}" mode="aspectFill" wx:if="{{item.order.product.images && item.order.product.images.length > 0}}"></image>
        <view class="product-img placeholder" wx:else><text>æš‚æ— å›¾</text></view>
        <view class="product-info">
          <text class="product-name">{{item.order.product.name}}</text>
          <text class="product-order">è®¢å•: {{item.order.order_no}}</text>
        </view>
        <text class="refund-amount">Â¥{{item.amount}}</text>
      </view>

      <!-- åº•éƒ¨æ“ä½œ -->
      <view class="refund-footer">
        <text class="refund-no">é€€æ¬¾å•å·: {{item.refund_no}}</text>
        <view class="refund-actions">
          <view class="btn-cancel" wx:if="{{item.status === 'pending'}}" catchtap="onCancelRefund" data-id="{{item.id}}" data-index="{{index}}">å–æ¶ˆç”³è¯·</view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty" wx:if="{{!loading && refunds.length === 0}}">
      <text class="empty-icon">ğŸ”„</text>
      <text class="empty-text">æš‚æ— å”®åè®°å½•</text>
    </view>

    <!-- åŠ è½½ -->
    <view class="load-more" wx:if="{{refunds.length > 0}}">
      <text wx:if="{{hasMore}}">ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
      <text wx:else>æ²¡æœ‰æ›´å¤šè®°å½•äº†</text>
    </view>

    <view class="loading" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text>åŠ è½½ä¸­...</text>
    </view>
    </view>
  </scroll-view>
</view>
