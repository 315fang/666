<!--pages/search/search.wxml - æœç´¢é¡µ-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-wrap">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input" 
             placeholder="æœç´¢å•†å“åç§°" 
             value="{{keyword}}" 
             bindinput="onInput" 
             bindconfirm="onSearch"
             focus="{{true}}"
             confirm-type="search" />
      <view class="clear-btn" wx:if="{{keyword}}" bindtap="onClear">âœ•</view>
    </view>
    <view class="cancel-btn" bindtap="onCancel">å–æ¶ˆ</view>
  </view>

  <!-- æœç´¢å†å² -->
  <view class="history-section" wx:if="{{!hasSearched && history.length > 0}}">
    <view class="section-header">
      <text class="section-title">æœç´¢å†å²</text>
      <text class="section-action" bindtap="onClearHistory">æ¸…ç©º</text>
    </view>
    <view class="history-tags">
      <view class="history-tag" wx:for="{{history}}" wx:key="*this" bindtap="onHistoryTap" data-keyword="{{item}}">
        <text>{{item}}</text>
      </view>
    </view>
  </view>

  <!-- çƒ­é—¨æœç´¢ -->
  <view class="hot-section" wx:if="{{!hasSearched && hotKeywords.length > 0}}">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨æœç´¢</text>
    </view>
    <view class="hot-tags">
      <view class="hot-tag" wx:for="{{hotKeywords}}" wx:key="*this" bindtap="onHistoryTap" data-keyword="{{item}}">
        <text class="hot-rank" wx:if="{{index < 3}}">{{index + 1}}</text>
        <text>{{item}}</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view class="result-section" wx:if="{{hasSearched}}">
    <view class="result-header" wx:if="{{products.length > 0}}">
      <text class="result-count">æ‰¾åˆ° {{products.length}} ä»¶å•†å“</text>
    </view>

    <!-- å•†å“åˆ—è¡¨ -->
    <view class="product-grid">
      <view class="product-card" 
            wx:for="{{products}}" wx:key="id"
            bindtap="onProductTap" data-item="{{item}}">
        <view class="product-image-wrap">
          <image class="product-image" src="{{item.images[0]}}" mode="aspectFill"></image>
        </view>
        <view class="product-info">
          <text class="product-name">{{item.name}}</text>
          <view class="product-bottom">
            <view class="price-box">
              <text class="currency">Â¥</text>
              <text class="price-num">{{item.retail_price}}</text>
            </view>
            <text class="sales-text" wx:if="{{item.sales_count > 0}}">å·²å”®{{item.sales_count}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºæœç´¢ç»“æœ -->
    <view class="empty" wx:if="{{!loading && products.length === 0}}">
      <text class="empty-icon">ğŸ”</text>
      <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³å•†å“</text>
      <text class="empty-sub">æ¢ä¸ªå…³é”®è¯è¯•è¯•å§</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
  </view>
</view>
