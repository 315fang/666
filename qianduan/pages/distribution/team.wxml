<!--pages/distribution/team.wxml-->
<view class="container">
  <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
  <view class="stats-card">
    <view class="stats-item">
      <text class="stats-val">{{directCount || 0}}</text>
      <text class="stats-label">ç›´æ¨æˆå‘˜</text>
    </view>
    <view class="stats-item">
      <text class="stats-val">{{indirectCount || 0}}</text>
      <text class="stats-label">äºŒä»£æˆå‘˜</text>
    </view>
    <view class="stats-item">
      <text class="stats-val">{{totalCount || 0}}</text>
      <text class="stats-label">å›¢é˜Ÿæ€»æ•°</text>
    </view>
  </view>

  <!-- é¢å¤–ç»Ÿè®¡ -->
  <view class="extra-stats">
    <view class="extra-item">
      <text class="extra-icon">ğŸ“ˆ</text>
      <text class="extra-label">å›¢é˜Ÿæ€»ä¸šç»©</text>
      <text class="extra-val">Â¥{{totalSales}}</text>
    </view>
    <view class="extra-item">
      <text class="extra-icon">ğŸ†•</text>
      <text class="extra-label">æœ¬æœˆæ–°å¢</text>
      <text class="extra-val">{{monthlyNewMembers}}äºº</text>
    </view>
    <view class="extra-item" wx:if="{{agentStockInfo}}">
      <text class="extra-icon">ğŸ“¦</text>
      <text class="extra-label">å·¥å‚åº“å­˜</text>
      <text class="extra-val">{{agentStockInfo.stock_count}}ä»¶</text>
    </view>
  </view>

  <!-- æœç´¢ç­›é€‰ -->
  <view class="tab-header">
    <view class="tab-item {{currentTab === 'direct' ? 'active' : ''}}" bindtap="switchTab" data-tab="direct">ç›´æ¨æˆå‘˜</view>
    <view class="tab-item {{currentTab === 'indirect' ? 'active' : ''}}" bindtap="switchTab" data-tab="indirect">ä¸‹çº§å›¢é˜Ÿ</view>
  </view>

  <!-- æˆå‘˜åˆ—è¡¨ -->
  <scroll-view class="member-list" scroll-y bindscrolltolower="onLoadMore">
    <!-- åˆ—è¡¨å®¹å™¨ -->
    <view class="member-list-container">
      <view class="member-item" wx:for="{{members}}" wx:key="id">
        <image class="member-avatar" src="{{item.avatar_url || '/assets/images/default-avatar.svg'}}" mode="aspectFill"></image>
        <view class="member-info">
          <view class="member-top">
            <text class="member-name">{{item.nickname}}</text>
            <text class="member-tag">{{item.role_name}}</text>
          </view>
          <view class="member-bottom">
            <text>åŠ å…¥: {{item.joined_at_format}}</text>
            <text class="member-sales">è®¢å•: {{item.order_count || 0}} | ä¸šç»©: Â¥{{item.total_sales_format}}</text>
          </view>
        </view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{members.length === 0 && !loading}}">
        <text class="empty-icon">ğŸ‘¥</text>
        <text>æš‚æ— å›¢é˜Ÿæˆå‘˜</text>
        <text class="empty-tip">åˆ†äº«é‚€è¯·ç ç»™å¥½å‹å³å¯å»ºç«‹å›¢é˜Ÿ</text>
      </view>

      <!-- åŠ è½½ä¸­ -->
      <view class="loading" wx:if="{{loading}}">
        <view class="spinner"></view>
      </view>
    </view>
  </scroll-view>
</view>
